<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="/theme/css/elegant.prod.9e9d5ce754.css" media="screen">
        <link rel="stylesheet" type="text/css" href="/theme/css/custom.css" media="screen">

        <link rel="dns-prefetch" href="//fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>

        <meta name="author" content="C.M. Cai" />

        <meta name="description" content="k近邻法的基本思想以及python实现方法，包括kd树的构建和搜索。
" />
        <meta name="twitter:creator" content="@CMCai0104">
        <meta property="og:type" content="article" />
        <meta name="twitter:card" content="summary">

<meta name="keywords" content="python, machine learning, machine learning, knn, kd-tree, machine learning" />

<meta property="og:title" content="k近邻法（knn）及kd树  - knn and kd-tree "/>
<meta property="og:url" content="/knn-kdtree" />
<meta property="og:description" content="k近邻法的基本思想以及python实现方法，包括kd树的构建和搜索。" />
<meta property="og:site_name" content="菜地" />
<meta property="og:article:author" content="C.M. Cai" />
<meta property="og:article:published_time" content="2018-11-08T00:00:00+08:00" />
<meta name="twitter:title" content="k近邻法（knn）及kd树  - knn and kd-tree ">
<meta name="twitter:description" content="k近邻法的基本思想以及python实现方法，包括kd树的构建和搜索。">
<meta property="og:image" content="https://cmcai0104.github.io/content/theme/images/apple-touch-icon-152x152.png" />
<meta name="twitter:image" content="https://cmcai0104.github.io/content/theme/images/apple-touch-icon-152x152.png" >

        <title>k近邻法（knn）及kd树  - knn and kd-tree  · 菜地
</title>
        <link rel="shortcut icon" href="/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png"  type="image/png" />
        <link rel="apple-touch-icon" sizes="57x57" href="/theme/images/apple-touch-icon-57x57.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="72x72" href="/theme/images/apple-touch-icon-72x72.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="76x76" href="/theme/images/apple-touch-icon-76x76.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="114x114" href="/theme/images/apple-touch-icon-114x114.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="120x120" href="/theme/images/apple-touch-icon-120x120.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="144x144" href="/theme/images/apple-touch-icon-144x144.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="/theme/images/apple-touch-icon-152x152.png" type="image/png" />
        <link rel="apple-touch-icon" sizes="152x152" href="/theme/images/apple-touch-icon-180x180.png" type="image/png" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="菜地 - Full Atom Feed" />


    </head>
    <body>
        <div id="content">
            <div class="navbar navbar-static-top">
                <div class="navbar-inner">
                    <div class="container-fluid">
                        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </a>
                        <a class="brand" href="/"><span class=site-name>菜地</span></a>
                        <div class="nav-collapse collapse">
                            <ul class="nav pull-right top-menu">
                                <li >
                                    <a href=
                                       "/"
                                    >Home</a>
                                </li>
                                <li ><a href="/categories">Categories</a></li>
                                <li ><a href="/tags">Tags</a></li>
                                <li ><a href="/archives">Archives</a></li>
                                <li><form class="navbar-search" action="/search" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <div class="container-fluid">
                <div class="row-fluid">
                    <div class="span1"></div>
                    <div class="span10">
<article itemscope>
<div class="row-fluid">
    <header class="page-header span10 offset2">
        <h1>
            <a href="/knn-kdtree">
                k近邻法（knn）及kd树
                <small class="subtitle">
                    knn and kd-tree
                </small>
            </a>
        </h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">
            
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* <span class="caps">CSS</span> font colors for translated <span class="caps">ANSI</span> escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #<span class="caps">3E424D</span>;
}
.ansi-black-bg {
  background-color: #<span class="caps">3E424D</span>;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #<span class="caps">E75C58</span>;
}
.ansi-red-bg {
  background-color: #<span class="caps">E75C58</span>;
}
.ansi-red-intense-fg {
  color: #<span class="caps">B22B31</span>;
}
.ansi-red-intense-bg {
  background-color: #<span class="caps">B22B31</span>;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #<span class="caps">DDB62B</span>;
}
.ansi-yellow-bg {
  background-color: #<span class="caps">DDB62B</span>;
}
.ansi-yellow-intense-fg {
  color: #<span class="caps">B27D12</span>;
}
.ansi-yellow-intense-bg {
  background-color: #<span class="caps">B27D12</span>;
}
.ansi-blue-fg {
  color: #<span class="caps">208FFB</span>;
}
.ansi-blue-bg {
  background-color: #<span class="caps">208FFB</span>;
}
.ansi-blue-intense-fg {
  color: #<span class="caps">0065CA</span>;
}
.ansi-blue-intense-bg {
  background-color: #<span class="caps">0065CA</span>;
}
.ansi-magenta-fg {
  color: #<span class="caps">D160C4</span>;
}
.ansi-magenta-bg {
  background-color: #<span class="caps">D160C4</span>;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #<span class="caps">60C6C8</span>;
}
.ansi-cyan-bg {
  background-color: #<span class="caps">60C6C8</span>;
}
.ansi-cyan-intense-fg {
  color: #<span class="caps">258F8F</span>;
}
.ansi-cyan-intense-bg {
  background-color: #<span class="caps">258F8F</span>;
}
.ansi-white-fg {
  color: #<span class="caps">C5C1B4</span>;
}
.ansi-white-bg {
  background-color: #<span class="caps">C5C1B4</span>;
}
.ansi-white-intense-fg {
  color: #<span class="caps">A1A6B2</span>;
}
.ansi-white-intense-bg {
  background-color: #<span class="caps">A1A6B2</span>;
}
.ansi-default-inverse-fg {
  color: #<span class="caps">FFFFFF</span>;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #<span class="caps">E3F2FD</span>;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #<span class="caps">E3F2FD</span>;
  border-right-width: 1px;
  background: #<span class="caps">E3F2FD</span>;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #<span class="caps">42A5F5</span>;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #<span class="caps">66BB6A</span>;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #<span class="caps">66BB6A</span>;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #<span class="caps">303F9F</span>;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In <span class="caps">CM2</span>, this used to be 0.4em, but in <span class="caps">CM3</span> it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In <span class="caps">CM3</span> this went to 4px from 0 in <span class="caps">CM2</span>. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #<span class="caps">BA2121</span>;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.highlight-meta {
  color: #<span class="caps">AA22FF</span>;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #<span class="caps">AA22FF</span>;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #<span class="caps">BA2121</span>;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #<span class="caps">AA22FF</span>;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but <span class="caps">FF</span> barfs all over that */
  height: 24em;
  /* <span class="caps">FF</span> needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/<span class="caps">FF</span> */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #<span class="caps">FF0000</span> } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #<span class="caps">BC7A00</span> } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #<span class="caps">FF0000</span> } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #<span class="caps">0044DD</span> } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #<span class="caps">BA2121</span> } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #<span class="caps">AA22FF</span> } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #<span class="caps">D2413A</span>; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #<span class="caps">0000FF</span> } /* Name.Function */
.highlight .nl { color: #<span class="caps">A0A000</span> } /* Name.Label */
.highlight .nn { color: #<span class="caps">0000FF</span>; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #<span class="caps">AA22FF</span>; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #<span class="caps">BA2121</span> } /* Literal.String.Affix */
.highlight .sb { color: #<span class="caps">BA2121</span> } /* Literal.String.Backtick */
.highlight .sc { color: #<span class="caps">BA2121</span> } /* Literal.String.Char */
.highlight .dl { color: #<span class="caps">BA2121</span> } /* Literal.String.Delimiter */
.highlight .sd { color: #<span class="caps">BA2121</span>; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #<span class="caps">BA2121</span> } /* Literal.String.Double */
.highlight .se { color: #<span class="caps">BB6622</span>; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #<span class="caps">BA2121</span> } /* Literal.String.Heredoc */
.highlight .si { color: #<span class="caps">BB6688</span>; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #<span class="caps">BB6688</span> } /* Literal.String.Regex */
.highlight .s1 { color: #<span class="caps">BA2121</span> } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #<span class="caps">0000FF</span> } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="&#32479;&#35745;&#23398;&#20064;&#26041;&#27861;&#8212;&#8212;k&#36817;&#37051;&#27861;&#65288;kNN&#65289;">&#32479;&#35745;&#23398;&#20064;&#26041;&#27861;&#8212;&#8212;k&#36817;&#37051;&#27861;&#65288;kNN&#65289;<a class="anchor-link" href="#&#32479;&#35745;&#23398;&#20064;&#26041;&#27861;&#8212;&#8212;k&#36817;&#37051;&#27861;&#65288;kNN&#65289;">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>k近邻法常用来处理分类问题（多分类），有时也能够用来处理回归问题。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>假设给定一个训练数据集，其中每个实例样本的类别已经确定，此时有一个新的实例输入，需要判断其类别，这就是一个分类问题。</p>
<p>而kNN算法则根据新输入的实例距离最近的k个训练实例预测（判断）其类别。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这里以鸢尾花数据集为例，用python代码说明此问题：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#获取数据</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;鸢尾花类型有：&#39;</span><span class="p">,</span><span class="n">iris</span><span class="o">.</span><span class="n">target_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;鸢尾花数据集包括的特征有：&#39;</span><span class="p">,</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>鸢尾花类型有： [&#39;setosa&#39; &#39;versicolor&#39; &#39;virginica&#39;]
鸢尾花数据集包括的特征有： [&#39;sepal length (cm)&#39;, &#39;sepal width (cm)&#39;, &#39;petal length (cm)&#39;, &#39;petal width (cm)&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>为方便可视化，对数据进行预处理，主要包括：</p>
<ol>
<li><p>只选两类花的数据，即&#8217;setosa&#8217;和&#8217;versicolor&#8217;</p>
</li>
<li><p>只选两个特征，即&#8217;sepal length (cm)&#8217;和&#8217;sepal width&nbsp;(cm)</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 获取y数据，筛选出0和1</span>
<span class="n">iris_Y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="n">iris_sub_Y</span> <span class="o">=</span> <span class="n">iris_Y</span><span class="p">[</span><span class="n">iris_Y</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">]</span>
<span class="c1"># 获取x数据，筛选出y维0或1的x</span>
<span class="n">iris_X</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span>
<span class="n">iris_sub_X</span> <span class="o">=</span> <span class="n">iris_X</span><span class="p">[</span><span class="n">iris_Y</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">][:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#绘制散点图 &#39;setosa&#39;为绿色 &#39;versicolor&#39; 为红色，&#39;sepal length (cm)&#39;为x轴，&#39;sepal width (cm)为y轴绘图</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[4]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a23266d68&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>此时，如果有一个新的样本（蓝色），&#8217;sepal length (cm)&#8217;和&#8217;sepal width (cm)&#8217;分别为5.4cm和3.2cm，如何判断其实是&#8217;setosa&#8217;为绿色还是 &#8216;versicolor&#8217;&nbsp;为红色</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">iris_sub_X</span><span class="p">[</span><span class="n">iris_sub_Y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">5.4</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[5]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a23367a58&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>kNN的思想是，找与样本点距离最近的k个样本，然后根据他们的类型判断样本的类型</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>最简单的方法就是计算这个新样本与数据集的距离</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">5.4</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">]</span>
<span class="n">distances</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_train</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">x_train</span> <span class="ow">in</span> <span class="n">iris_sub_X</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>然后根据计算的距离找到最近的k个样本的类型，取k=5</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nearest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">distances</span><span class="p">)</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">topK_y</span> <span class="o">=</span> <span class="p">[</span><span class="n">iris_sub_Y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">nearest</span><span class="p">[:</span><span class="n">k</span><span class="p">]]</span>
<span class="n">topK_y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[7]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[0, 0, 1, 1, 1]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>所以我们发现最近的k=5个样本中，有2个&#8217;setosa&#8217;，3个&nbsp;&#8216;versicolor&#8217;。</p>
<p>然后可以根据出现频率最高的类型判断样本类型</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="n">Counter</span><span class="p">(</span><span class="n">topK_y</span><span class="p">)</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[8]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#27880;&#24847;&#65306;">&#27880;&#24847;&#65306;<a class="anchor-link" href="#&#27880;&#24847;&#65306;">&#182;</a></h2><p>kNN法需要考虑量刚的问题，例如：某一维度是1000级（1000，1001，998），而另一维是10级（10，12，7），这样前一维度在计算距离时候可能就会站比较大的影响。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#25299;&#23637;&#65306;">&#25299;&#23637;&#65306;<a class="anchor-link" href="#&#25299;&#23637;&#65306;">&#182;</a></h2><ol>
<li><p>这里计算新样本点与测试数据集距离是默认采用了欧式距离，其实采用其他距离也是可以的；</p>
</li>
<li><p>k是超参数，需要通过调试进行选择。k如果选得太大则没有意义（例如：极端的k等于样本数量），而k取太小会受随机因素的影响（例如：极端的k=1，则最近一个样本的误差直接会导致结果的问题）；</p>
</li>
<li><p>最后的根据频率选择，其实也可以根据其他的方式，例如距离作为权重计算加权和，此时k近邻法就是一个回归问题了。</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>距离度量：</p>
<ol>
<li>$L_{p}$距离也叫 Minkowski 距离：$L_{p}(x_{i}, x_{j}) = (\sum_{l=1}^{n}|x_{i}^{(l)} -&nbsp;x_{j}^{(l)}|^{p})^{\frac{1}{p}})$ </li>
<li>p=2时，就是欧式距离</li>
<li>p=1时，称为曼哈顿距离</li>
<li>$p=\infty $，即$L_{\infty}(x_{i}, x_{j})=max_{l}| x_{i}^{(l)} - x_{j}^{(l)}&nbsp;|$</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="kd&#26641;">kd&#26641;<a class="anchor-link" href="#kd&#26641;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上面方法虽然可以解决，kNN的问题，而且从思想上来说比较简单易懂。</p>
<p>但是，我们还需考虑到计算机计算量的问题，&nbsp;如果样本很多，且样本的特征也很多，则上述方法计算效率很低，不适合大规模数据的应用。</p>
<p>kd树则很好得解决了这个问题。</p>
<p>kd树主要分为两步：1、构造kd树；2、搜索kd树。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#26500;&#24314;kd&#26641;">&#26500;&#24314;kd&#26641;<a class="anchor-link" href="#&#26500;&#24314;kd&#26641;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>一个简单例子，构造kd树，假设数据集为：$T = \{ (2, 3)^T,   (5, 4)^T,   (9, 6)^T,   (4, 7)^T,   (8, 1)^T,   (7, 2)^T&nbsp;\}$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[9]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a234344e0&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>首先计算第一维数据的中位数（注：在统计学的前沿文献中一般定义分位数$\mathscr{t}_{p} = inf(x: P(X &lt;=&nbsp;x)&gt;=p)$）,采用这种方法计算中位数上述例子的结果是7，而一般的简单计算中位数遇到偶数个数据采用中间两个的均值处理）</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[10]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>6.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[11]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.lines.Line2D at 0x1a2346cd68&gt;</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>这样上面的6个点就被分成了两组$T_{x1&lt;6} = \{ (2, 3)^T,   (5, 4)^T,  (4, 7)^T \}$和$T_{x2&gt;6} = \{  (9, 6)^T,   (8, 1)^T,   (7, 2)^T&nbsp;\}$。</p>
<p>接下啦，分别对这两组数据根据第二维分别计算中位数，然后进行划分</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[12]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1a235c4080&gt;]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>然后，在上一维划分的基础上，再对下一维度进行划分（如果没有下一维则回到第一维，一般要求垂直即可，在kd树中采用深度对特征维数取余数的方法），直到分尽为止。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">a</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">9</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[13]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&lt;matplotlib.lines.Line2D at 0x1a236964a8&gt;]</pre>
</div>

</div>

<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="kd&#26641;&#26500;&#24314;python&#23454;&#29616;">kd&#26641;&#26500;&#24314;python&#23454;&#29616;<a class="anchor-link" href="#kd&#26641;&#26500;&#24314;python&#23454;&#29616;">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>首先，构建测试数据集，假设样本有100个，每个样本有10个特征</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ndata</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">ndim</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">data</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">ndata</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ndata</span><span class="p">,</span><span class="n">ndim</span><span class="p">))</span>
<span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[14]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>(100, 10)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>因为树的每个节点其实是一个if-then的条件判断，同时kd树是一个二叉树。所以在每个节点需要给出每个分支的条件。因此，需要构建一个array存储令为hrect。</p>
<p>hrect为2行10列（列数同特征数），其中第一行为进入该节点的数据每个特征的最小值，第二行为最大值。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">hrect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
<span class="n">hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
<span class="n">hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>首先以第一维数据的中位数对data进行分割</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span> <span class="c1">#获取第一维数据的序号</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">,:]</span> <span class="c1">#对data进行从小到大排序</span>
<span class="n">splitval</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#获取第一维数据的分割点，也就是中位数</span>

<span class="n">left_hrect</span> <span class="o">=</span> <span class="n">hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">left_hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span> <span class="c1">#左分支的条件</span>
<span class="n">right_hrect</span> <span class="o">=</span> <span class="n">hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">right_hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span> <span class="c1">#右分支条件</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>构建数，树在python中用list表示，list的每个元素表示树的节点用tuple表示。</p>
<p>每个tuple包含的该节点的基本信息，包括：该节点下数据（样本）的索引（只有当节点是叶节点时才会有，否则维None），该节点下的数据（样本）（也只有是叶节点才会有，否则维None），该节点左分支的条件（只有不是叶节点才有，叶节点为None），该节点右分支的条件（只有不是叶节点才有，叶节点为None），以及该节点左分支下一个节点在树中的索引和右分支下一个节点在树中的索引。</p>
<p>同时还需要构建一个list令为stack，用于存储还需要进行再分的数据。该list的每个元素也是一个tuple。</p>
<p>该tuple包含：需要处理的数据和他们的索引，当前节点深度，父节点深度，左分支还是右分支（这里用布尔值，左分支为True）</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
<span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">data</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),:],</span> <span class="n">idx</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">),</span>
        <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):,:],</span> <span class="n">idx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">),]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>接下来，进入下一层，对数据进行分类，首先从stack获取数据，因为stack用来存储需要分类的数据，同时非空list的布尔值为True，那么可以通过 while&nbsp;stack进行循环，每次循环通过pop截取list中最后一项，产生新数据时再通过append，即可。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">,</span> <span class="n">didx</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">leftbranch</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c1"># 更新数据，分别用data，didx，depth，parent，leftbranch表示当前循环需要处理的数据，以及他们的索引，深度、父节点在tree中的索引，是不是左分支等</span>
<span class="n">ndata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#当前数据样本个数</span>
<span class="n">nodeptr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="c1">#当前树的深度。</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>下面对上一层树进行更新，更新的目的，是要告诉父节点它的左（或右）节点在tree这个list中的位置。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="c1">#先获取父节点数据</span>
<span class="n">tree</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="k">if</span> <span class="n">leftbranch</span> <span class="k">else</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">)</span> <span class="c1">#告诉父节点它的左或右分支在tree的位置</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>接下来，判断当前的节点是不是叶节点，也就是数据是否还需要再分。</p>
<p>首先设置一个<strong>叶节点最大样本数量的限制变量</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">leafsize</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果当前节点数据样本树少于&nbsp;leafsize，则无需再分，只需要对tree新增一个叶节点即可，stack不需要改变</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">ndata</span> <span class="o">&lt;=</span> <span class="n">leafsize</span><span class="p">:</span>
    <span class="n">_didx</span> <span class="o">=</span> <span class="n">didx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#叶节点不需要再判断条件也没有左右分支，所以分别取为None和0</span>
    <span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>否则</strong>，还需要对数据进行再分，对第几维特征进行划分（前面讲过为：深度相对于特征总维数的余），然后进行排序划分，更新stack（因为此时不是叶节点，还有下一级节点）</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitdim</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">%</span> <span class="n">ndim</span> <span class="c1">#对第几维进行划分</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">splitdim</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span> <span class="c1">#获取splitdim的排序序号</span>
<span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#对data进行从小到大排序</span>
<span class="n">didx</span> <span class="o">=</span> <span class="n">didx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1">#对上一级节点传递下来的数据索引也要排序，保证最后能找到所有样本原来的位置</span>
<span class="n">nodeptr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="c1">#nodeptr保存在tree中，表示节点在tree中的位置，这也要存储到stack中，在下一次处理时候才能够找到父节点</span>
<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">:],</span> <span class="n">didx</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
<span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):,</span> <span class="p">:],</span> <span class="n">didx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>下面还要对tree进行更新</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">splitval</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">splitdim</span><span class="p">]</span>
<span class="k">if</span> <span class="n">leftbranch</span><span class="p">:</span>
    <span class="n">left_hrect</span> <span class="o">=</span> <span class="n">_left_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">right_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">left_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">right_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">left_hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">splitdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span>
<span class="n">right_hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">splitdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span>
<span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>完整定义函数code：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">kdtree</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">leafsize</span><span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">ndata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">hrect</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="n">ndim</span><span class="p">))</span>
    <span class="n">hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
    <span class="n">hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span> <span class="c1">#获取第一维数据的序号</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">,:]</span> <span class="c1">#对data进行从小到大排序</span>
    <span class="n">splitval</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#获取第一维数据的分割点，也就是中位数</span>

    <span class="n">left_hrect</span> <span class="o">=</span> <span class="n">hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">left_hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span> <span class="c1">#左分支的条件</span>
    <span class="n">right_hrect</span> <span class="o">=</span> <span class="n">hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">right_hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span> <span class="c1">#右分支条件</span>

    <span class="n">tree</span> <span class="o">=</span> <span class="p">[(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[(</span><span class="n">data</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),:],</span> <span class="n">idx</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">),(</span><span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):,:],</span> <span class="n">idx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">),]</span>
    
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">didx</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">leftbranch</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span> <span class="c1"># 更新数据，分别用data，didx，depth，parent，leftbranch表示当前循环需要处理的数据，以及他们的索引，深度、父节点在tree中的索引，是不是左分支等</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#当前数据样本个数</span>
        <span class="n">nodeptr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="c1">#当前树的深度。</span>

        <span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="c1">#先获取父节点数据</span>
        <span class="n">tree</span><span class="p">[</span><span class="n">parent</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="n">right</span><span class="p">)</span> <span class="k">if</span> <span class="n">leftbranch</span> <span class="k">else</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="n">_left_hrect</span><span class="p">,</span> <span class="n">_right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">)</span> <span class="c1">#告诉父节点它的左或右分支在tree的位置</span>

        <span class="k">if</span> <span class="n">ndata</span> <span class="o">&lt;=</span> <span class="n">leafsize</span><span class="p">:</span>
            <span class="n">_didx</span> <span class="o">=</span> <span class="n">didx</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">leaf</span> <span class="o">=</span> <span class="p">(</span><span class="n">_didx</span><span class="p">,</span> <span class="n">_data</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1">#叶节点不需要再判断条件也没有左右分支，所以分别取为None和0</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">leaf</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">splitdim</span> <span class="o">=</span> <span class="n">depth</span> <span class="o">%</span> <span class="n">ndim</span> <span class="c1">#对第几维进行划分</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">splitdim</span><span class="p">],</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span> <span class="c1">#获取splitdim的排序序号</span>
            <span class="n">data</span><span class="p">[:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#对data进行从小到大排序</span>
            <span class="n">didx</span> <span class="o">=</span> <span class="n">didx</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="c1">#对上一级节点传递下来的数据索引也要排序，保证最后能找到所有样本原来的位置</span>
            <span class="n">nodeptr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span> <span class="c1">#nodeptr保存在tree中，表示节点在tree中的位置，这也要存储到stack中，在下一次处理时候才能够找到父节点</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">:],</span> <span class="n">didx</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">)],</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
            <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):,</span> <span class="p">:],</span> <span class="n">didx</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">):],</span> <span class="n">depth</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">nodeptr</span><span class="p">,</span> <span class="kc">False</span><span class="p">))</span>

            <span class="n">splitval</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">ndata</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">splitdim</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">leftbranch</span><span class="p">:</span>
                <span class="n">left_hrect</span> <span class="o">=</span> <span class="n">_left_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">right_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">left_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">right_hrect</span> <span class="o">=</span> <span class="n">_right_hrect</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">left_hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">splitdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span>
            <span class="n">right_hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">splitdim</span><span class="p">]</span> <span class="o">=</span> <span class="n">splitval</span>
            <span class="n">tree</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">tree</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#25628;&#32034;kd&#26641;">&#25628;&#32034;kd&#26641;<a class="anchor-link" href="#&#25628;&#32034;kd&#26641;">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>上面已经完成了对kd树的构建，此时如果有一个新的样本，如何寻找跟其距离最近的k个点呢？</p>
<ol>
<li><p>找到该新样本所在的叶节点：从根节点出发，递归逐级向下寻找，直到子节点为叶节点为止。</p>
</li>
<li><p>以此节点为“当前最近点”。</p>
</li>
<li><p>再递归向上寻找，在每个节点：首先，如果该节点保存的实例点比当前最近距离更近，则以该实例点为‘最近点’；如果存在“新的最近点”则其一定是在该节点的一个子节点内（检查该子节点的区域是否与以目标点为圆心，以“当前最近距离”为半径的球相交）；如果相交则在该子节点内可能存在距离目标更近的点，移动到该节点再进行搜索。</p>
</li>
<li><p>直到搜索到根节点为止。</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="&#25628;&#32034;kd&#26641;&#30340;python&#23454;&#29616;">&#25628;&#32034;kd&#26641;&#30340;python&#23454;&#29616;<a class="anchor-link" href="#&#25628;&#32034;kd&#26641;&#30340;python&#23454;&#29616;">&#182;</a></h2><p>这里我们参考scipy提供的kd树搜索代码，对上述代码略作修改，从树根向节点进行搜索。其实方法是大同小异的。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>首先通过上面的代码构建一个kd树tree，一个测试数据datapoint和K</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree</span> <span class="o">=</span> <span class="n">kdtree</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">ntest</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">datapoint</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">ntest</span> <span class="o">*</span> <span class="n">ndim</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">ntest</span><span class="p">,</span><span class="n">ndim</span><span class="p">))</span>
<span class="n">K</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>首先同样通过stack来存储需要处理的节点，knn用来存储最近的K个点到测试点的距离（按从小到大排，默认无穷的）,_datapt为一个测试样本</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
<span class="n">knn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">K</span>
<span class="n">_datapt</span> <span class="o">=</span> <span class="n">datapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>同样的，每次对stack进行结尾，然后对当前节点进行处理。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">leaf_idx</span><span class="p">,</span> <span class="n">leaf_data</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>因为我们知道在构建kd tree的时候，对于叶节点来说leaf_idx和leaf_data非空，而中间节点left_hrect和right_hrect非空。所以可以根据根据&nbsp;leaf_idx是否为None判断是不是叶节点。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果不是叶节点，则判断当前节点的左右两个分支是否有可能存在比当前最近的K个点更近的点。</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#定义一个判断中间节点的分支内是否有更近的点存在，其实计算的是测试数据与该分支的条件（范围）的距离，所以只需要计算不在该范围内的特征所产生的距离。</span>
<span class="c1">#其中hrect表示分支的条件，r2表示要成为最近的K个点之一的最大距离，centroid表示中心（也就是测试数据）</span>
<span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">hrect</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">centroid</span><span class="p">):</span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="n">hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#获取该分支各特征的最大值</span>
    <span class="n">minval</span> <span class="o">=</span> <span class="n">hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#各特征的最小值</span>
    <span class="c1"># 设置一个参数p，p在大部分特征与测试数据相同，只有当该特征的数据不在这范围内时才与centroid不同</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
    <span class="n">idx</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">minval</span> 
    <span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">minval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">maxval</span>
    <span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">p</span><span class="o">-</span><span class="n">centroid</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r2</span> <span class="c1">#计算距离</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>因为在每个中间节点都存在左右两个分支，所以都需要判断一下，然后根据判断结果True or&nbsp;False对节点的下一层是否还需要进行搜索</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">intersect</span><span class="p">(</span><span class="n">left_hrect</span><span class="p">,</span> <span class="n">knn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">_datapt</span><span class="p">):</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">left</span><span class="p">])</span>
<span class="k">if</span> <span class="n">intersect</span><span class="p">(</span><span class="n">right_hrect</span><span class="p">,</span> <span class="n">knn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">_datapt</span><span class="p">):</span>
    <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">right</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>如果是叶节点，则计算</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#定义一个函数计算叶节点中数据与测试数据的距离，并判断是否小于“当前最小距离”中的任意一个。</span>
<span class="c1">#其中data表示测试数据，lidx和ldata表示该叶节点上的数据及其索引。</span>
<span class="k">def</span> <span class="nf">quadratic_knn_search</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lidx</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">ndata</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">param</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">K</span> <span class="k">if</span> <span class="n">K</span> <span class="o">&lt;</span> <span class="n">ndata</span> <span class="k">else</span> <span class="n">ndata</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sqd</span> <span class="o">=</span> <span class="p">((</span><span class="n">ldata</span> <span class="o">-</span> <span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">sqd</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="n">K</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sqd</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">lidx</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>完整的搜索kd树代码如下：</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">quadratic_knn_search</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">lidx</span><span class="p">,</span> <span class="n">ldata</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">ndata</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">param</span> <span class="o">=</span> <span class="n">ldata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">K</span> <span class="k">if</span> <span class="n">K</span> <span class="o">&lt;</span> <span class="n">ndata</span> <span class="k">else</span> <span class="n">ndata</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">sqd</span> <span class="o">=</span> <span class="p">((</span><span class="n">ldata</span> <span class="o">-</span> <span class="n">data</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">sqd</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;mergesort&#39;</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span><span class="p">[:</span><span class="n">K</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sqd</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">lidx</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">intersect</span><span class="p">(</span><span class="n">hrect</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">centroid</span><span class="p">):</span>
    <span class="n">maxval</span> <span class="o">=</span> <span class="n">hrect</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#获取该分支各特征的最大值</span>
    <span class="n">minval</span> <span class="o">=</span> <span class="n">hrect</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#各特征的最小值</span>
    <span class="c1"># 设置一个参数p，p在大部分特征与测试数据相同，只有当该特征的数据不在这范围内时才与centroid不同</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">centroid</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> 
    <span class="n">idx</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="n">minval</span> 
    <span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">minval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">maxval</span>
    <span class="n">p</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxval</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">((</span><span class="n">p</span><span class="o">-</span><span class="n">centroid</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">r2</span> <span class="c1">#计算距离</span>

<span class="k">def</span> <span class="nf">search_kdtree</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">datapoint</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span>
    <span class="n">stack</span> <span class="o">=</span> <span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">knn</span> <span class="o">=</span> <span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="kc">None</span><span class="p">)]</span> <span class="o">*</span> <span class="n">K</span>
    <span class="n">_datapt</span> <span class="o">=</span> <span class="n">datapoint</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>
    <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
        <span class="n">leaf_idx</span><span class="p">,</span> <span class="n">leaf_data</span><span class="p">,</span> <span class="n">left_hrect</span><span class="p">,</span> <span class="n">right_hrect</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">leaf_idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">_knn</span> <span class="o">=</span> <span class="n">quadratic_knn_search</span><span class="p">(</span><span class="n">datapoint</span><span class="p">,</span> <span class="n">leaf_idx</span><span class="p">,</span> <span class="n">leaf_data</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_knn</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">knn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">knn</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">knn</span> <span class="o">+</span> <span class="n">_knn</span><span class="p">)[:</span><span class="n">K</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">intersect</span><span class="p">(</span><span class="n">left_hrect</span><span class="p">,</span> <span class="n">knn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">_datapt</span><span class="p">):</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">left</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">intersect</span><span class="p">(</span><span class="n">right_hrect</span><span class="p">,</span> <span class="n">knn</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">_datapt</span><span class="p">):</span>
                <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="n">right</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">knn</span>
</pre></div>

    </div>
</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>



             
 
                <p id="post-share-links">
    Like this post? Share on:
      <a href="https://twitter.com/intent/tweet?text=k%E8%BF%91%E9%82%BB%E6%B3%95%EF%BC%88knn%EF%BC%89%E5%8F%8Akd%E6%A0%91%20knn%20and%20kd-tree&url=/knn-kdtree&via=CMCai0104&hashtags=python,machine-learning" target="_blank" rel="nofollow noopener noreferrer" title="Share on Twitter">Twitter</a>
 ❄       <a href="https://www.facebook.com/sharer/sharer.php?u=/knn-kdtree" target="_blank" rel="nofollow noopener noreferrer" title="Share on Facebook">Facebook</a>
 ❄       <a href="mailto:?subject=k%E8%BF%91%E9%82%BB%E6%B3%95%EF%BC%88knn%EF%BC%89%E5%8F%8Akd%E6%A0%91%20knn%20and%20kd-tree&amp;body=/knn-kdtree" target="_blank" rel="nofollow noopener noreferrer" title="Share via Email">Email</a>

            
            







            <hr/>
<section>
    <h2>Keep Reading</h2>
<ul class="related-posts-list">
<li><a href="/navie-bayes" title="朴素贝叶斯方法（naive bayes） - navie bayes">朴素贝叶斯方法（naive bayes） <small>navie bayes</small></a></li>
<li><a href="/kama" title="卡夫曼自适应均线(KAMA) - kama">卡夫曼自适应均线(KAMA) <small>kama</small></a></li>
</ul>
<hr />
</section>
            <aside>
            <nav>
            <ul class="articles-timeline">
                <li class="previous-article">« <a href="/blogstruct" title="Previous: 使用pelican在GitHub搭建个人Jupyter Notebook和Markdown微博">使用pelican在GitHub搭建个人Jupyter Notebook和Markdown微博</a></li>
                <li class="next-article"><a href="/navie-bayes" title="Next: 朴素贝叶斯方法（naive bayes） - navie bayes">朴素贝叶斯方法（naive bayes） <small class="subtitle">navie bayes</small></a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section id="article-sidebar" class="span2">
            <h4>Published</h4>
            <time itemprop="dateCreated" datetime="2018-11-08T00:00:00+08:00">Nov 08, 2018</time>
            <h4>Category</h4>
            <a class="category-link" href="/categories#machine-learning-ref">machine learning</a>
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article">
                <li><a href="/tags#machine-learning-ref">machine learning
                    <span class="superscript">2</span>
</a></li>
                <li><a href="/tags#python-ref">python
                    <span class="superscript">3</span>
</a></li>
            </ul>
<h4>Stay in Touch</h4>
<div id="sidebar-social-link">
    <a href="https://twitter.com/CMCai0104" title="CMCai's Twitter" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Twitter" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1da1f3"/><path fill="#fff" d="M437 152a72 72 0 0 1-40 12 72 72 0 0 0 32-40 72 72 0 0 1-45 17 72 72 0 0 0-122 65 200 200 0 0 1-145-74 72 72 0 0 0 22 94 72 72 0 0 1-32-7 72 72 0 0 0 56 69 72 72 0 0 1-32 1 72 72 0 0 0 67 50 200 200 0 0 1-105 29 200 200 0 0 0 309-179 200 200 0 0 0 35-37"/></svg>
    </a>
    <a href="https://github.com/cmcai0104" title="CMCai's Github" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="GitHub" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#1B1817"/><path fill="#fff" d="M335 499c14 0 12 17 12 17H165s-2-17 12-17c13 0 16-6 16-12l-1-50c-71 16-86-28-86-28-12-30-28-37-28-37-24-16 1-16 1-16 26 2 40 26 40 26 22 39 59 28 74 22 2-17 9-28 16-35-57-6-116-28-116-126 0-28 10-51 26-69-3-6-11-32 3-67 0 0 21-7 70 26 42-12 86-12 128 0 49-33 70-26 70-26 14 35 6 61 3 67 16 18 26 41 26 69 0 98-60 120-117 126 10 8 18 24 18 48l-1 70c0 6 3 12 16 12z"/></svg>
    </a>
    <a href="mailto:mailto:hzxsccm678335@163.com" title="CMCai's Email" target="_blank" rel="nofollow noopener noreferrer">
        <svg xmlns="http://www.w3.org/2000/svg" aria-label="Mail" role="img" viewBox="0 0 512 512"><rect width="512" height="512" rx="15%" fill="#328cff"/><path d="m250 186c-46 0-69 35-69 74 0 44 29 72 68 72 43 0 73-32 73-75 0-44-34-71-72-71zm-1-37c30 0 57 13 77 33 0-22 35-22 35 1v150c-1 10 10 16 16 9 25-25 54-128-14-187-64-56-149-47-195-15-48 33-79 107-49 175 33 76 126 99 182 76 28-12 41 26 12 39-45 19-168 17-225-82-38-68-36-185 67-248 78-46 182-33 244 32 66 69 62 197-2 246-28 23-71 1-71-32v-11c-20 20-47 32-77 32-57 0-108-51-108-108 0-58 51-110 108-110" fill="#fff"/></svg>
    </a>
</div>
            





            



        </section>
</div>
</article>
<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>                    </div>
                    <div class="span1"></div>
                </div>
            </div>
        </div>
<footer>
    <div>
        Content licensed under <a rel="license nofollow noopener noreferrer"
    href="http://creativecommons.org/licenses/by/4.0/" target="_blank">
    Creative Commons Attribution 4.0 International License</a>.
    </div>

    <div>
        <span class="site-name">菜地</span> - Welcome to C.M. Cai's Blogs
    </div>



    <div id="fpowered">
        Powered by: <a href="http://getpelican.com/" title="Pelican Home Page" target="_blank" rel="nofollow noopener noreferrer">Pelican</a>
        Theme: <a href="https://elegant.oncrashreboot.com/" title="Theme Elegant Home Page" target="_blank" rel="nofollow noopener noreferrer">Elegant</a>
        Hosted on:
        <a href=https://www.netlify.com/ target="_blank" rel="nofollow noopener noreferrer">
            Netlify
        </a>
    </div>
</footer>            <script src="//code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
        <script src="/theme/js/elegant.prod.9e9d5ce754.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

    <script>
    (function () {
        if (window.location.hash.match(/^#comment-\d+$/)) {
            $('#comment_thread').collapse('show');
        }
    })();
    window.onhashchange=function(){
        if (window.location.hash.match(/^#comment-\d+$/))
            window.location.reload(true);
    }
    $('#comment_thread').on('shown', function () {
        var link = document.getElementById('comment-accordion-toggle');
        var old_innerHTML = link.innerHTML;
        $(link).fadeOut(200, function() {
            $(this).text('Click here to hide comments').fadeIn(200);
        });
        $('#comment_thread').on('hidden', function () {
            $(link).fadeOut(200, function() {
                $(this).text(old_innerHTML).fadeIn(200);
            });
        })
    })
</script>

    </body>
    <!-- Theme: Elegant built for Pelican
        License : MIT -->
</html>